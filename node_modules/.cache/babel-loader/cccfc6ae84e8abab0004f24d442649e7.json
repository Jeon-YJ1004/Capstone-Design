{"ast":null,"code":"var _jsxFileName = \"C:\\\\project\\\\capstone\\\\src\\\\components\\\\result.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\n/* global kakao */\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport axios from 'axios';\nimport { Select, Card, Row, Col, Typography, Rate } from 'antd';\nimport ReactHtmlParser from 'react-html-parser'; // import CafeInfo from '../routes/info/cafe_info';\n\nimport Axios from 'axios';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  kakao\n} = window;\nconst {\n  Title\n} = Typography;\nconst {\n  Option\n} = Select;\n\nfunction SearchData(pageNumber, params, setWidth) {\n  _s();\n\n  const {\n    place\n  } = params;\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false); //   const [latitude,setLatitude]=useState('');\n  //   const [longitude,setLongitude]=useState('');\n  //   const [cafe_id,setCafe_id]=useState('');\n\n  const [data, setData] = useState([]);\n  const [hasMore, setHasMore] = useState(false);\n  let cancel;\n  useEffect(() => {\n    Axios.get('http://localhost:8000/api/get').then(response => {\n      setData(response.data);\n    });\n  }, [data]); //   const setMap = (data) => {\n  //       const container = document.getElementById(\"map\");\n  //       const options = {\n  //           center: new kakao.maps.LatLng(data[0].lat, data[0].lon),\n  //           level: 5\n  //       };\n  //       const handleResize = () => {\n  //           setWidth(window.innerWidth);\n  //       }\n  //       const map = new kakao.maps.Map(container, options);\n  //       // 오른쪽에 지도 컨트롤 표시\n  //       var zoomControl = new kakao.maps.ZoomControl();\n  //       map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);\n  //       var bounds = new kakao.maps.LatLngBounds();    \n  //       var imageSrc = \"https://1.bp.blogspot.com/-08ebwsVzqag/YSXWjBOHKPI/AAAAAAAAD9s/lRd5ya_9A2AgPtylT9oyilWIGohCTv9XQCLcBGAsYHQ/s834/dark_marker.png\";   \n  //       for (var i = 0; i < data.length; i ++) {\n  //           var latlng = new kakao.maps.LatLng(data[i].lat, data[i].lon)\n  //           var imageSize = new kakao.maps.Size(15, 22); \n  //           var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize); \n  //           var marker = new kakao.maps.Marker({\n  //               map: map,\n  //               position: latlng,\n  //               title : data[i].name,\n  //               image : markerImage\n  //           });\n  //           // 마커 클릭 하면 확대\n  //           kakao.maps.event.addListener(marker, 'click', function(){\n  //               map.setLevel(1, {anchor: this.getPosition()});\n  //           });\n  //           var infowindow = new kakao.maps.InfoWindow({\n  //               content: `<div class=\"infoWindow\">${data[i].name}</div>`\n  //           });\n  //           (function(marker, infowindow) {\n  //               // 마커에 mouseover 이벤트를 등록하고 마우스 오버 시 인포윈도우를 표시합니다 \n  //               kakao.maps.event.addListener(marker, 'mouseover', function() {\n  //                   infowindow.open(map, marker);\n  //                   var bgDiv = infowindow.a\n  //                   bgDiv.style.borderColor = \"#9ba2bd\"\n  //                   bgDiv.style.borderRadius = \"10px\"\n  //                   bgDiv.children[1].style = \"text-align: center; width: 150px;\"\n  //               });\n  //               kakao.maps.event.addListener(marker, 'mouseout', function() {\n  //                   infowindow.close();\n  //               });\n  //           })(marker, infowindow);\n  //           // bounds = 모든 마커가 보이도록 지도 범위 설정\n  //           bounds.extend(latlng)\n  //       }\n  //       map.setBounds(bounds);\n  //       window.addEventListener('resize', handleResize);\n  //       return () => {\n  //           window.removeEventListener('resize', handleResize);\n  //       }\n  //   }\n  //   useEffect(() => {\n  //       if (pageNumber === 0){\n  //           setData([])\n  //       }\n  //       setLoading(true);\n  //       setError(false);\n  //       axios({\n  //           method: 'GET',\n  //           url: `/cafes?searching=${place}`,\n  //           params: { page: pageNumber },\n  //           cancelToken: new axios.CancelToken(c => cancel = c)\n  //       }).then(res => {\n  //           setData(prevData => {\n  //               return [... new Set([...prevData, ...res.data.content])]\n  //           });\n  //           if (pageNumber == 0){\n  //               setMap(res.data.content)\n  //           } else {\n  //               setMap([... new Set([...data, ...res.data.content])])\n  //           }\n  //           setHasMore(res.data.content.length > 0);\n  //           setLoading(false);\n  //       }).catch(e => {\n  //           if (axios.isCancel(e)) return\n  //           setError(true)\n  //       })\n  //       return () => cancel()\n  //   }, [pageNumber, params])\n  //   return {data, loading, hasMore};\n}\n\n_s(SearchData, \"nj7ayNh9j5wpHI1daP3exK3poo4=\");\n\n_c = SearchData;\n\nfunction Result(props) {\n  _s2();\n\n  const params = props.match.params;\n  const [width, setWidth] = useState(window.innerWidth); //   const [pageNumber, setPageNumber] = useState(0);\n  //   const { data, loading, error, hasMore } = SearchData(pageNumber, params, setWidth);\n  //   useEffect(() => {\n  //       setPageNumber(0)\n  //   }, [params])  \n  //   const changeSort = (type) => {\n  //       const {place} = params\n  //       props.history.push({\n  //           pathname: `/search/${place}`\n  //       });\n  //   }\n  //   const observer = useRef()\n  //   const lastDataRef = useCallback(node => {\n  //       if (loading) return\n  //       if (observer.current) observer.current.disconnect()\n  //       observer.current = new IntersectionObserver(entries => {\n  //           if (entries[0].isIntersecting && hasMore){\n  //               setPageNumber(prevNum => prevNum + 1)\n  //           }\n  //       })\n  //       if (node) observer.current.observe(node)\n  //   }, [loading, hasMore])\n\n  const onCafeClick = cafe => {\n    props.history.push({\n      pathname: `/info/${cafe.id}`,\n      state: {\n        cafe\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Row, {\n    children: [/*#__PURE__*/_jsxDEV(Col, {\n      span: 24,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"map\",\n        style: {\n          width: `${width - 200}px`,\n          height: '40vh'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(Col, {\n      span: 24,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sort\",\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          value: props.match.params.sort,\n          onChange: changeSort,\n          children: /*#__PURE__*/_jsxDEV(Option, {\n            value: \"star\",\n            children: \"\\uBCC4\\uC810\\uC21C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(Col, {\n      span: 24,\n      className: \"list\",\n      children: data.map((d, index) => {\n        if (data.length === index + 1) {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"listItem\",\n            ref: lastDataRef,\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  span: 18,\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"info\",\n                    onClick: () => onCafeClick(d),\n                    children: [/*#__PURE__*/_jsxDEV(Title, {\n                      level: 2,\n                      style: {\n                        margin: 0,\n                        color: \"#dba56c\"\n                      },\n                      children: d.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 199,\n                      columnNumber: 39\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: d.address\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 200,\n                      columnNumber: 39\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 35\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  span: 6,\n                  children: /*#__PURE__*/_jsxDEV(Rate, {\n                    allowHalf: true,\n                    disabled: true,\n                    defaultValue: d.star\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 35\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 203,\n                  columnNumber: 31\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 27\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 23\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 19\n          }, this);\n        } else {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"listItem\",\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: [/*#__PURE__*/_jsxDEV(Col, {\n                  span: 18,\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"info\",\n                    onClick: () => onCafeClick(d),\n                    children: [/*#__PURE__*/_jsxDEV(Title, {\n                      level: 2,\n                      style: {\n                        margin: 0,\n                        color: \"#dba56c\"\n                      },\n                      children: d.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 221,\n                      columnNumber: 39\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: d.address\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 222,\n                      columnNumber: 39\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 220,\n                    columnNumber: 35\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 216,\n                  columnNumber: 31\n                }, this), /*#__PURE__*/_jsxDEV(Col, {\n                  span: 6,\n                  children: /*#__PURE__*/_jsxDEV(Rate, {\n                    allowHalf: true,\n                    disabled: true,\n                    defaultValue: d.star\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 226,\n                    columnNumber: 35\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 225,\n                  columnNumber: 31\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 27\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 23\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 19\n          }, this);\n        }\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 172,\n    columnNumber: 7\n  }, this);\n}\n\n_s2(Result, \"SdN5bKv+q9B1nP/OEMj+ZPpOgCQ=\");\n\n_c2 = Result;\nexport default _c3 = withRouter(Result);\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"SearchData\");\n$RefreshReg$(_c2, \"Result\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["C:/project/capstone/src/components/result.js"],"names":["React","useState","useEffect","useRef","useCallback","withRouter","axios","Select","Card","Row","Col","Typography","Rate","ReactHtmlParser","Axios","BrowserRouter","Router","Route","Switch","kakao","window","Title","Option","SearchData","pageNumber","params","setWidth","place","loading","setLoading","error","setError","data","setData","hasMore","setHasMore","cancel","get","then","response","Result","props","match","width","innerWidth","onCafeClick","cafe","history","push","pathname","id","state","height","sort","changeSort","map","d","index","length","lastDataRef","margin","color","name","address","star"],"mappings":"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","sourcesContent":["/* global kakao */\r\nimport React, {useState, useEffect, useRef, useCallback} from 'react';\r\nimport { withRouter} from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { Select, Card, Row, Col, Typography, Rate } from 'antd';\r\nimport ReactHtmlParser from 'react-html-parser';\r\n// import CafeInfo from '../routes/info/cafe_info';\r\n\r\nimport Axios from 'axios';\r\nimport { BrowserRouter as Router,Route,Switch} from 'react-router-dom';\r\nconst {\r\n  kakao\r\n} = window;\r\n\r\nconst { Title } = Typography;\r\nconst { Option } = Select;\r\n\r\n\r\nfunction SearchData(pageNumber, params, setWidth){\r\n  const {place} = params\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n\r\n//   const [latitude,setLatitude]=useState('');\r\n//   const [longitude,setLongitude]=useState('');\r\n//   const [cafe_id,setCafe_id]=useState('');\r\n  \r\n  const [data, setData] = useState([]);\r\n  const [hasMore, setHasMore] = useState(false);\r\n  let cancel;\r\n\r\n  useEffect(()=>{\r\n    Axios.get('http://localhost:8000/api/get').then((response)=>{\r\n      setData(response.data);\r\n    })\r\n  },[data])\r\n//   const setMap = (data) => {\r\n//       const container = document.getElementById(\"map\");\r\n//       const options = {\r\n//           center: new kakao.maps.LatLng(data[0].lat, data[0].lon),\r\n//           level: 5\r\n//       };\r\n//       const handleResize = () => {\r\n//           setWidth(window.innerWidth);\r\n//       }\r\n//       const map = new kakao.maps.Map(container, options);\r\n  \r\n//       // 오른쪽에 지도 컨트롤 표시\r\n//       var zoomControl = new kakao.maps.ZoomControl();\r\n//       map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);\r\n\r\n//       var bounds = new kakao.maps.LatLngBounds();    \r\n//       var imageSrc = \"https://1.bp.blogspot.com/-08ebwsVzqag/YSXWjBOHKPI/AAAAAAAAD9s/lRd5ya_9A2AgPtylT9oyilWIGohCTv9XQCLcBGAsYHQ/s834/dark_marker.png\";   \r\n//       for (var i = 0; i < data.length; i ++) {\r\n//           var latlng = new kakao.maps.LatLng(data[i].lat, data[i].lon)\r\n\r\n//           var imageSize = new kakao.maps.Size(15, 22); \r\n//           var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize); \r\n\r\n//           var marker = new kakao.maps.Marker({\r\n//               map: map,\r\n//               position: latlng,\r\n//               title : data[i].name,\r\n//               image : markerImage\r\n//           });\r\n\r\n//           // 마커 클릭 하면 확대\r\n//           kakao.maps.event.addListener(marker, 'click', function(){\r\n//               map.setLevel(1, {anchor: this.getPosition()});\r\n//           });\r\n\r\n//           var infowindow = new kakao.maps.InfoWindow({\r\n//               content: `<div class=\"infoWindow\">${data[i].name}</div>`\r\n//           });\r\n\r\n//           (function(marker, infowindow) {\r\n//               // 마커에 mouseover 이벤트를 등록하고 마우스 오버 시 인포윈도우를 표시합니다 \r\n//               kakao.maps.event.addListener(marker, 'mouseover', function() {\r\n//                   infowindow.open(map, marker);\r\n\r\n//                   var bgDiv = infowindow.a\r\n//                   bgDiv.style.borderColor = \"#9ba2bd\"\r\n//                   bgDiv.style.borderRadius = \"10px\"\r\n//                   bgDiv.children[1].style = \"text-align: center; width: 150px;\"\r\n//               });\r\n\r\n//               kakao.maps.event.addListener(marker, 'mouseout', function() {\r\n//                   infowindow.close();\r\n//               });\r\n//           })(marker, infowindow);\r\n\r\n//           // bounds = 모든 마커가 보이도록 지도 범위 설정\r\n//           bounds.extend(latlng)\r\n//       }\r\n//       map.setBounds(bounds);\r\n//       window.addEventListener('resize', handleResize);\r\n//       return () => {\r\n//           window.removeEventListener('resize', handleResize);\r\n//       }\r\n//   }\r\n\r\n//   useEffect(() => {\r\n//       if (pageNumber === 0){\r\n//           setData([])\r\n//       }\r\n//       setLoading(true);\r\n//       setError(false);\r\n//       axios({\r\n//           method: 'GET',\r\n//           url: `/cafes?searching=${place}`,\r\n//           params: { page: pageNumber },\r\n//           cancelToken: new axios.CancelToken(c => cancel = c)\r\n//       }).then(res => {\r\n//           setData(prevData => {\r\n              \r\n//               return [... new Set([...prevData, ...res.data.content])]\r\n//           });\r\n//           if (pageNumber == 0){\r\n//               setMap(res.data.content)\r\n//           } else {\r\n//               setMap([... new Set([...data, ...res.data.content])])\r\n//           }\r\n//           setHasMore(res.data.content.length > 0);\r\n//           setLoading(false);\r\n//       }).catch(e => {\r\n//           if (axios.isCancel(e)) return\r\n//           setError(true)\r\n//       })\r\n//       return () => cancel()\r\n//   }, [pageNumber, params])\r\n//   return {data, loading, hasMore};\r\n}\r\n\r\nfunction Result(props){\r\n  const params = props.match.params\r\n\r\n  const [width, setWidth] = useState(window.innerWidth);\r\n//   const [pageNumber, setPageNumber] = useState(0);\r\n//   const { data, loading, error, hasMore } = SearchData(pageNumber, params, setWidth);\r\n\r\n//   useEffect(() => {\r\n//       setPageNumber(0)\r\n//   }, [params])  \r\n\r\n//   const changeSort = (type) => {\r\n//       const {place} = params\r\n//       props.history.push({\r\n//           pathname: `/search/${place}`\r\n//       });\r\n//   }\r\n\r\n//   const observer = useRef()\r\n//   const lastDataRef = useCallback(node => {\r\n//       if (loading) return\r\n//       if (observer.current) observer.current.disconnect()\r\n//       observer.current = new IntersectionObserver(entries => {\r\n//           if (entries[0].isIntersecting && hasMore){\r\n//               setPageNumber(prevNum => prevNum + 1)\r\n//           }\r\n//       })\r\n//       if (node) observer.current.observe(node)\r\n//   }, [loading, hasMore])\r\n\r\n  const onCafeClick = (cafe) => {\r\n      props.history.push({\r\n        pathname: `/info/${cafe.id}`,\r\n        state: { cafe },\r\n      });\r\n  };\r\n  return (\r\n      <Row>\r\n          <Col span={24}>\r\n          <div id=\"map\" style={{\r\n              width: `${width - 200}px`,\r\n              height: '40vh'\r\n          }}>\r\n          </div>\r\n          </Col>\r\n          <Col span={24}>\r\n          <div className=\"sort\">\r\n              <Select value={props.match.params.sort} onChange={changeSort}>\r\n                  <Option value=\"star\">별점순</Option>\r\n              </Select>\r\n          </div>\r\n          </Col>\r\n          <Col span={24} className=\"list\">\r\n          {data.map((d, index) => {\r\n          if (data.length === index + 1){\r\n              return (\r\n                  <div className=\"listItem\" key={index} ref={lastDataRef}>\r\n                      <Card>\r\n                          <Row>\r\n                              <Col span={18}>\r\n                                  {/* <div className=\"img-div\">\r\n                                      <img src={d.img_path ? `http://${d.img_path}` : \"https://1.bp.blogspot.com/-ZO8wGSRzFBA/YSnWa5QV6ZI/AAAAAAAAD-Y/3n5lSJwrx-Yh3McA1GpGCg6POSjrvsPPwCLcBGAsYHQ/s800/noimage.png\"} alt={d.name} />\r\n                                  </div> */}\r\n                                  <div className=\"info\" onClick={() => onCafeClick(d)}>\r\n                                      <Title level={2} style={{margin: 0, color: \"#dba56c\"}}>{d.name}</Title>\r\n                                      <p>{d.address}</p>\r\n                                  </div>\r\n                              </Col>\r\n                              <Col span={6}>\r\n                                  <Rate allowHalf disabled defaultValue={d.star} />\r\n                              </Col>\r\n                          </Row>\r\n                      </Card>\r\n                  </div>\r\n              )\r\n          }\r\n          else {\r\n              return (\r\n                  <div className=\"listItem\" key={index}>\r\n                      <Card>\r\n                          <Row>\r\n                              <Col span={18}>\r\n                                  {/* <div className=\"img-div\">\r\n                                      <img src={d.img_path ? `http://${d.img_path}` : \"https://1.bp.blogspot.com/-ZO8wGSRzFBA/YSnWa5QV6ZI/AAAAAAAAD-Y/3n5lSJwrx-Yh3McA1GpGCg6POSjrvsPPwCLcBGAsYHQ/s800/noimage.png\"} alt={d.name} />\r\n                                  </div> */}\r\n                                  <div className=\"info\" onClick={() => onCafeClick(d)}>\r\n                                      <Title level={2} style={{margin: 0, color: \"#dba56c\"}}>{d.name}</Title>\r\n                                      <p>{d.address}</p>\r\n                                  </div>\r\n                              </Col>\r\n                              <Col span={6}>\r\n                                  <Rate allowHalf disabled defaultValue={d.star} />\r\n                              </Col>\r\n                          </Row>\r\n                      </Card>\r\n                  </div>\r\n              )\r\n          }\r\n      })}\r\n          </Col>\r\n      </Row>\r\n  )\r\n}\r\n\r\nexport default withRouter(Result)"]},"metadata":{},"sourceType":"module"}